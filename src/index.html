<!doctype html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta
      http-equiv="Content-Security-Policy"
      content="
        connect-src socket: https: http: blob: ipc: npm: node: wss: ws: ws://localhost:*;
         script-src socket: https: http: blob: npm: node: http://localhost:* 'unsafe-eval' 'unsafe-inline';
         worker-src socket: https: http: blob: 'unsafe-eval' 'unsafe-inline';
          frame-src socket: https: http: blob: http://localhost:*;
            img-src socket: https: http: blob: http://localhost:*;
          child-src socket: https: http: blob:;
         object-src 'none';
      "
    >
    <style type="text/css"></style>
    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/chatbox.css">
    <link rel="stylesheet" href="styles/login.css">
  </head>
  <body>
    
    <!-- LOGIN -->
    <div id="login" style = "display: grid;">
      <div id="loginPage">
        <h2>Login</h2>
        <form id="loginForm">
          <div id="nameLogin">
            <label for="displayName">Display Name:</label>
            <input onkeyup="sendMessageEnter()"   type="text" id="displayName" required />
          </div>
            <br />
          <div id="clusterLogin">
            <label for="clusterId">Cluster ID:</label>
            <input type="text" id="clusterId" required />
            <br />
          </div>
          <div id="loginSubmitButton">
            <button  type="submit">Login</button>
          </div>
        </form>
    </div>
    </div>    
    <!-- CHAT -->
    
    <div id="chatBox" style="display:none;">
      <label id="nameLabel">Logged in as</label>
      <div id= "chatPage" style="display: flex; flex-direction: column; align-items: center;">
        <!-- Chat Box -->
        <div id="messageBox" style="border-color: black;"></div>
         
        <!-- Message Input -->
        <div>
             <input type="text"    onkeydown="sendMessageEnter()" id="messageInput" placeholder="Type a message..." />
            <button onclick="sendMessage()">Send as</button>
        </div>
        <!-- Message Type -->
        <div style="margin-top: 10px;">
          Would you like to send this message as:
          <select id="sendMessageType" onchange="toggleDirectMessageSelect()">
            <option>Broadcast</option>
            <option>Direct Message</option>
          </select>
        <br>
        <div id="directMessageSelectWrapper" style="display: none;">
            Send message to:
        </div>
        <select id="directMessageSelect" style="display: none;">    
            <!-- Options will be populated by JavaScript -->
        </select>
        <div id="selectedUserDisplay" style="display: none; margin-top: 5px; font-style: italic;">
            Selected: <span id="selectedUserName"></span>
        </div>
      </div>
      <div id="logoutButtonContainer">
        <button id="logoutButton" onclick="handleLogout()">
          Logout
        </button>
      </div>
      </div>
    </div>
    <script src="index.js" type="module" defer></script>
  </body>
</html>
